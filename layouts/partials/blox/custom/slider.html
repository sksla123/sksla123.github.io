{{/* Hugo Blox: Slider */}}
{{/* Documentation: https://hugoblox.com/blocks/ */}}
{{/* License: https://github.com/HugoBlox/hugo-blox-builder/blob/main/LICENSE.md */}}

{{/* Initialise */}}
<!-- <link rel="stylesheet" href="{{ "/css/slider.css" | relURL }}"> -->
<!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous"> -->
<!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script> -->
{{ $page := .wcPage }}
{{ $block := .wcBlock }}
{{ $hash_id := .wcIdentifier }}
{{ $slide_count := len $block.content.slides }}

<div id="{{ $hash_id }}" class="relative w-full" data-carousel="slide">
    <!-- Carousel wrapper -->
    <div class="relative h-[{{ $block.design.slide_height }}] overflow-hidden rounded-lg">
        {{ range $index, $item := $block.content.slides }}
        <div class="hidden duration-700 ease-in-out {{if eq $index 0}}active{{end}}" data-carousel-item>
            {{ with $item.background.image.filename }}
            <img src="{{ . | relURL }}" class="absolute block w-full -translate-x-1/2 -translate-y-1/2 top-1/2 left-1/2" alt="{{ $item.title }}">
            {{ end }}
            <div class="absolute inset-0 flex items-center justify-center" style="background-color: {{ $item.background.color }}; opacity: 0.7;">
                <div class="text-center">
                    <h1 class="text-xl font-bold">{{ $item.title | markdownify }}</h1>
                    <p>{{ $item.content | markdownify }}</p>
                    {{ if $item.link.url }}
                    <a href="{{ $item.link.url }}" class="mt-4 inline-block px-4 py-2 bg-white text-black rounded">
                        {{ $item.link.text | markdownify }}
                    </a>
                    {{ end }}
                </div>
            </div>
        </div>
        {{ end }}
    </div>

    <!-- Slider indicators -->
    <div class="absolute z-30 flex -translate-x-1/2 bottom-5 left-1/2 space-x-3 rtl:space-x-reverse">
        {{ range $index, $item := $block.content.slides }}
        <button type="button" class="w-3 h-3 rounded-full" aria-current="{{ if eq $index 0 }}true{{ else }}false{{ end }}" aria-label="Slide {{ add $index 1 }}" data-carousel-slide-to="{{ $index }}"></button>
        {{ end }}
    </div>

    <!-- Slider controls -->
    <button type="button" class="absolute top-0 start-0 z-30 flex items-center justify-center h-full px-4 cursor-pointer group focus:outline-none" data-carousel-prev>
        <span class="inline-flex items-center justify-center w-10 h-10 rounded-full bg-white/30 group-hover:bg-white/50">
            <svg class="w-4 h-4 text-black" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 6 10">
                <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 1 1 5l4 4"/>
            </svg>
            <span class="sr-only">Previous</span>
        </span>
    </button>
    <button type="button" class="absolute top-0 end-0 z-30 flex items-center justify-center h-full px-4 cursor-pointer group focus:outline-none" data-carousel-next>
        <span class="inline-flex items-center justify-center w-10 h-10 rounded-full bg-white/30 group-hover:bg-white/50">
            <svg class="w-4 h-4 text-black" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 6 10">
                <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 9 4-4-4-4"/>
            </svg>
            <span class="sr-only">Next</span>
        </span>
    </button>
</div>

<script>
  // 슬라이더 동작을 위한 JavaScript
  const carouselItems = document.querySelectorAll('[data-carousel-item]');
  const prevButton = document.querySelector('[data-carousel-prev]');
  const nextButton = document.querySelector('[data-carousel-next]');
  let currentIndex = 0;

  const showSlide = (index) => {
      carouselItems.forEach((item, i) => {
          item.classList.add('hidden');
          if (i === index) {
              item.classList.remove('hidden');
          }
      });
  };

  prevButton.addEventListener('click', () => {
      currentIndex = (currentIndex === 0) ? carouselItems.length - 1 : currentIndex - 1;
      showSlide(currentIndex);
  });

  nextButton.addEventListener('click', () => {
      currentIndex = (currentIndex === carouselItems.length - 1) ? 0 : currentIndex + 1;
      showSlide(currentIndex);
  });

  // 초기 슬라이드 표시
  showSlide(currentIndex);
</script>